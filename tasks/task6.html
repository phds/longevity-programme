<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>LOCATION</title>
    <link rel="icon" href="../assets/favicon.png">
    <link rel="stylesheet" href="../css/master.css">
    <link rel="stylesheet" href="../css/text-input.css">
    <link rel="stylesheet" href="../css/typed.css">
  </head>
  <body>
    <div class="container">
      <div class="primary">
        <div class="task">
          <div class="title">
            <span></span>
          </div>
          <div class="body">
            <span class="input location hide">
    					<input class="input__field location" type="text" id="task-input" placeholder="Budapest, Hungary" />
    					<label class="input__label" for="task-input">
    						<svg class="graphic" width="100%" height="100%" viewBox="0 0 404 77" preserveAspectRatio="none">
    							<path d="m0,0l404,0l0,77l-404,0l0,-77z"/>
    						</svg>
    					</label>
    				</span>
          </div>
        </div>
      </div>
      <div class="secondary">
        <span>+++ PRESS ENTER TO CONTINUE +++</span>
      </div>
    </div>
    <audio id="next" preload="auto" src="../audio/sfx/last.mp3" autobuffer\>
    <script src="../js/typed.js" charset="utf-8"></script>
    <script src="../js/main.js" charset="utf-8"></script>
    <script type="text/javascript">

      let validInput = false;
      let timeoutId;
      let input = document.querySelector(".input__field");
      let el = document.getElementById('task-input');

      type('.title>span', 'Enter your current location.', function(){
        el.parentNode.classList.remove('hide');
      });



      el.onkeypress = function(e){
        if(el.value.length > 5){
          setEnterAsNextPage('../end.html', true);
        }
        // var charCode = e.which || e.keyCode;
        // var charStr = String.fromCharCode(charCode);
        // if (!/[a-zA-Z0-9 ,.]/.test(charStr) || el.value.length > 16) {
        //     return false;
        // }

      }
      // el.onkeyup = function(e){
      //
      //   timeoutId = setTimeout(function(){
      //
      //   });
      //
      //   let numbers = el.value.split(' ');
      //   validInput = numbers.length == 5 && numbers[4] != "";
      //   if(validInput){
      //     input.classList.add('valid');
      //     setEnterAsNextPage('../end.html');
      //   }
      //   else {
      //     input.classList.remove('valid');
      //     removeEnterAsNextPage();
      //   }
      //
      // }

      function insertAfter(newNode, referenceNode) {
          referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
      }

      let cursor = document.querySelector('.typed-cursor').cloneNode();
      el.onfocus = function(){
        document.querySelector('.typed-cursor').style.visibility = 'hidden';
        if(validInput) {
          input.classList.add('valid');
        }
      }

      el.onblur = function(){
        document.querySelector('.typed-cursor').style.visibility = 'visible';
        input.classList.remove('valid');
      }

    </script>
  </body>
</html>
