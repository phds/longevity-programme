<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>DATE</title>
    <link rel="stylesheet" href="../css/master.css">
    <link rel="stylesheet" href="../css/text-input.css">
    <link rel="stylesheet" href="../css/typed.css">
  </head>
  <body>
    <div class="container">
      <div class="primary">
        <div class="task">
          <div class="title">
            <span></span>
          </div>
          <div class="body">
            <span class="input date hide">
    					<input class="input__field date" type="text" id="task-input" placeholder="DD/MM" />
    					<label class="input__label" for="task-input">
    						<svg class="graphic" width="100%" height="100%" viewBox="0 0 404 77" preserveAspectRatio="none">
    							<path d="m0,0l404,0l0,77l-404,0l0,-77z"/>
    						</svg>
    					</label>
    				</span>
          </div>
        </div>
      </div>
      <div class="secondary">
        <span>+++ PRESS ENTER TO CONTINUE +++</span>
      </div>
    </div>
    <script src="../js/typed.js" charset="utf-8"></script>
    <script src="../js/main.js" charset="utf-8"></script>
    <script type="text/javascript">

      let dateValid = false;
      let input = document.querySelector(".input__field");
      let el = document.getElementById('task-input');

      type('.title>span', 'Insert the DD/MM of your birth date.', function(){
        el.parentNode.classList.remove('hide');
      });

      el.onkeypress = function(e){

        var charCode = e.which || e.keyCode;
        var charStr = String.fromCharCode(charCode);
        if (!/[0-9]/.test(charStr) || el.value.length > 4) {
            return false;
        }

      }
      el.onkeyup = function(e){
        if(el.value.length == 2 && e.keyCode != 8){
          el.value = el.value + '/';
        }
        else{
          let day = el.value.split("/")[0];
          let month = el.value.split("/")[1];
          dateValid = day <= 31 && month <= 12 && month.length == 2;
          let secondaryMessage = document.querySelector('.secondary>span');
          if(dateValid){
            input.classList.add('valid');
            setEnterAsNextPage('task2.html');
          }
          else {
            input.classList.remove('valid');
            removeEnterAsNextPage();
          }
        }
      }

      function insertAfter(newNode, referenceNode) {
          referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
      }

      let cursor = document.querySelector('.typed-cursor').cloneNode();
      el.onfocus = function(){
        document.querySelector('.typed-cursor').style.visibility = 'hidden';
        if(dateValid) {
          input.classList.add('valid');
        }
      }

      el.onblur = function(){
        document.querySelector('.typed-cursor').style.visibility = 'visible';
        input.classList.remove('valid');
      }

    </script>
  </body>
</html>
